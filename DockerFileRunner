FROM ubuntu:latest

RUN apt-get update && apt-get install -y curl jq git \
    && curl -fsSL https://deb.nodesource.com/setup_16.x | bash - \
    && apt-get install -y nodejs \
    && apt-get clean

ENV RUNNER_VERSION=2.310.1
ENV RUNNER_WORKDIR=/actions-runner/_work

WORKDIR /actions-runner

RUN curl -o actions-runner-linux-x64.tar.gz -L https://github.com/actions/runner/releases/download/v${RUNNER_VERSION}/actions-runner-linux-x64-${RUNNER_VERSION}.tar.gz && \
    tar xzf ./actions-runner-linux-x64.tar.gz && \
    bash ./bin/installdependencies.sh && \
    rm ./actions-runner-linux-x64.tar.gz

COPY entrypoint.sh /entrypoint.sh
RUN chmod +x /entrypoint.sh

ENTRYPOINT [ "/entrypoint.sh"]
